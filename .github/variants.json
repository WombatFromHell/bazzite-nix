{
  "_comment": "Image variant definitions for bazzite-nix builds",
  "_schema": {
    "variants": [
      {
        "name": "string",
        "base_image": "string",
        "build_script": "string (optional, default: 'build.sh')",
        "suffix": "string (optional)",
        "latest": "boolean (optional, default: false)",
        "tags": {
          "branch": "string (optional, default: base_image_tag)",
          "versioned": ["string (supports {canonical}, {branch} placeholders)"]
        },
        "tags_default": "If 'tags' is omitted, generates: [base_image_tag, base_image_tag-canonical, canonical]",
        "disabled": "boolean (optional, default: false)"
      }
    ],
    "_output": "Fields computed by check-variants.sh for each variant needing a build:",
    "output_fields": {
      "variant": "string - the variant name",
      "base_image": "string - the base image reference",
      "build_script": "string - the build script to use",
      "suffix": "string - the suffix (may be empty)",
      "parent_version": "string - version label from upstream base image",
      "digest": "string - SHA256 digest of upstream base image (without sha256: prefix)",
      "canonical_tag": "string - computed canonical version tag (with collision handling)",
      "tags": "string - comma-separated list of tags to apply",
      "prev_ref": "string - full image ref of previous build for rechunk (may be empty)",
      "needs_build": "boolean - whether this variant needs rebuilding"
    }
  },
  "variants": [
    {
      "name": "stable",
      "base_image": "ghcr.io/ublue-os/bazzite:stable"
    },
    {
      "name": "testing",
      "base_image": "ghcr.io/ublue-os/bazzite:testing",
      "latest": true,
      "tags": {
        "versioned": ["{branch}", "{branch}-{canonical}"]
      }
    },
    {
      "name": "cachyos",
      "suffix": "-cachyos",
      "base_image": "ghcr.io/ublue-os/bazzite:testing",
      "description": "Builds the bazzite image with kernel from cachyos copr",
      "build_script": "build-cachyos.sh",
      "latest": true
    },
    {
      "name": "upstream",
      "suffix": "-upstream",
      "base_image": "ghcr.io/ublue-os/bazzite:testing",
      "description": "Builds the bazzite image with kernel from testing-updates",
      "build_script": "build-upstream.sh",
      "latest": true,
      "disabled": true
    },
    {
      "name": "nvidia-open",
      "suffix": "-nvidia-open",
      "base_image": "ghcr.io/ublue-os/bazzite-nvidia-open:stable",
      "latest": true,
      "disabled": true
    },
    {
      "name": "deck",
      "suffix": "-deck",
      "base_image": "ghcr.io/ublue-os/bazzite-deck:stable",
      "latest": true,
      "disabled": true
    }
  ]
}
